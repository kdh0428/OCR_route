The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
2025-11-05 04:50:57,276 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.023 min_margin=0.897 legacy=True dynamic=True tau_H=0.700 tau_m=1.000 structured=False
Experiment baseline_no_ocr:   0%|▎                                                                                                | 1/300 [00:35<2:56:47, 35.48s/it]2025-11-05 04:51:15,174 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.012 min_margin=1.085 legacy=False dynamic=False tau_H=0.700 tau_m=1.000 structured=False
Experiment baseline_no_ocr:   1%|▋                                                                                                | 2/300 [00:53<2:04:50, 25.14s/it]2025-11-05 04:51:39,792 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.023 min_margin=0.014 legacy=True dynamic=True tau_H=0.700 tau_m=1.000 structured=False
Experiment baseline_no_ocr:   1%|▉                                                                                                | 3/300 [01:17<2:03:15, 24.90s/it]2025-11-05 04:51:54,850 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.005 min_margin=3.311 legacy=False dynamic=False tau_H=0.700 tau_m=1.000 structured=False
Experiment baseline_no_ocr:   1%|█▎                                                                                               | 4/300 [01:33<1:43:40, 21.01s/it]2025-11-05 04:52:23,770 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.059 min_margin=0.644 legacy=True dynamic=True tau_H=0.700 tau_m=1.000 structured=False
Experiment baseline_no_ocr:   2%|█▌                                                                                               | 5/300 [02:01<1:57:20, 23.87s/it]2025-11-05 04:53:06,690 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.011 min_margin=2.928 legacy=False dynamic=False tau_H=0.700 tau_m=1.000 structured=False
Experiment baseline_no_ocr:   2%|█▉                                                                                               | 6/300 [02:44<2:28:41, 30.34s/it]2025-11-05 04:53:57,398 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.018 min_margin=1.002 legacy=False dynamic=False tau_H=0.700 tau_m=1.000 structured=False
Experiment baseline_no_ocr:   2%|██▎                                                                                              | 7/300 [03:35<3:00:41, 37.00s/it]2025-11-05 04:54:17,439 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.025 min_margin=0.263 legacy=True dynamic=True tau_H=0.700 tau_m=1.000 structured=False
Experiment baseline_no_ocr:   3%|██▌                                                                                              | 8/300 [03:55<2:33:47, 31.60s/it]2025-11-05 04:54:56,022 | INFO | ocr_route.routing | Routing decision: mean_entropy=0.006 min_margin=1.655 legacy=False dynamic=False tau_H=0.700 tau_m=1.000 structured=False
Traceback (most recent call last):                                                                                                                                  
  File "/root/OCR_route/OCR-route/scripts/run_dataset_eval.py", line 1001, in <module>
    "limit": args.limit,
  File "/root/OCR_route/OCR-route/scripts/run_dataset_eval.py", line 963, in main
    sample_iter, dataset_total = iter_samples(args)
  File "/root/OCR_route/OCR-route/scripts/run_dataset_eval.py", line 721, in run_experiment
    try:
  File "/root/OCR_route/OCR-route/ocr_route/main.py", line 28, in run
    return route(
  File "/root/OCR_route/OCR-route/ocr_route/routing.py", line 227, in route
    first_pass = _run_pass(
  File "/root/OCR_route/OCR-route/ocr_route/routing.py", line 147, in _run_pass
    result = generate(model, processor, inputs, config=generation_cfg)
  File "/root/OCR_route/OCR-route/ocr_route/inference.py", line 65, in generate
    outputs = model.generate(**model_inputs, **generation_kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/transformers/generation/utils.py", line 2564, in generate
    result = decoding_method(
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/transformers/generation/utils.py", line 2787, in _sample
    outputs = model_forward(**model_inputs, return_dict=True)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/accelerate/hooks.py", line 175, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/transformers/utils/generic.py", line 1064, in wrapper
    outputs = func(self, *args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/transformers/models/qwen3_vl/modeling_qwen3_vl.py", line 1362, in forward
    logits = self.lm_head(hidden_states[:, slice_indices, :])
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/accelerate/hooks.py", line 170, in new_forward
    args, kwargs = module._hf_hook.pre_forward(module, *args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/accelerate/hooks.py", line 360, in pre_forward
    set_module_tensor_to_device(
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/accelerate/utils/modeling.py", line 343, in set_module_tensor_to_device
    new_value = value.to(device, non_blocking=non_blocking)
KeyboardInterrupt
Traceback (most recent call last):
  File "/root/OCR_route/OCR-route/scripts/run_dataset_eval.py", line 1001, in <module>
    "limit": args.limit,
  File "/root/OCR_route/OCR-route/scripts/run_dataset_eval.py", line 963, in main
    sample_iter, dataset_total = iter_samples(args)
  File "/root/OCR_route/OCR-route/scripts/run_dataset_eval.py", line 721, in run_experiment
    try:
  File "/root/OCR_route/OCR-route/ocr_route/main.py", line 28, in run
    return route(
  File "/root/OCR_route/OCR-route/ocr_route/routing.py", line 227, in route
    first_pass = _run_pass(
  File "/root/OCR_route/OCR-route/ocr_route/routing.py", line 147, in _run_pass
    result = generate(model, processor, inputs, config=generation_cfg)
  File "/root/OCR_route/OCR-route/ocr_route/inference.py", line 65, in generate
    outputs = model.generate(**model_inputs, **generation_kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/transformers/generation/utils.py", line 2564, in generate
    result = decoding_method(
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/transformers/generation/utils.py", line 2787, in _sample
    outputs = model_forward(**model_inputs, return_dict=True)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/accelerate/hooks.py", line 175, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/transformers/utils/generic.py", line 1064, in wrapper
    outputs = func(self, *args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/transformers/models/qwen3_vl/modeling_qwen3_vl.py", line 1362, in forward
    logits = self.lm_head(hidden_states[:, slice_indices, :])
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/accelerate/hooks.py", line 170, in new_forward
    args, kwargs = module._hf_hook.pre_forward(module, *args, **kwargs)
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/accelerate/hooks.py", line 360, in pre_forward
    set_module_tensor_to_device(
  File "/root/miniconda3/envs/ocr/lib/python3.10/site-packages/accelerate/utils/modeling.py", line 343, in set_module_tensor_to_device
    new_value = value.to(device, non_blocking=non_blocking)
KeyboardInterrupt
